@inherits LayoutComponentBase
@inject IDialogService DialogService

<MudThemeProvider @rendermode="InteractiveServer" Theme="_theme" @bind-IsDarkMode="_isDarkMode" />
<MudLayout>
	<MudMainContent>
		<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="py-4">
			@Body
		</MudContainer>
	</MudMainContent>
	
	<!-- Floating buttons in top-right corner -->
	<div style="position: fixed; top: 8px; right: 8px; z-index: 1000; display: flex; gap: 4px;">
		<MudIconButton Icon="@Icons.Material.Filled.History"
		               Color="Color.Default"
		               Size="Size.Medium"
		               OnClick="OpenHistory"
		               Title="Action History"
		               Style="opacity: 0.7;"
		               Class="toolbar-btn" />
		<MudIconButton Icon="@Icons.Material.Filled.Settings"
		               Color="Color.Default"
		               Size="Size.Medium"
		               OnClick="OpenSettings"
		               Title="Settings"
		               Style="opacity: 0.7;"
		               Class="toolbar-btn" />
	</div>
</MudLayout>

<style>
	.toolbar-btn:hover {
		opacity: 1 !important;
	}
</style>

@code {
	private bool _isDarkMode = true;

	private MudTheme _theme = new MudTheme()
	{
		PaletteLight = new PaletteLight()
		{
			Primary = "#594ae2",
			AppbarBackground = "#27272f",
			AppbarText = "#ffffff",
			DrawerBackground = "#27272f",
			DrawerText = "#ffffff"
		},
		PaletteDark = new PaletteDark()
		{
			Primary = "#7e6fff",
			Secondary = "#48a9a6",
			Tertiary = "#e4a854",
			Background = "#1a1a2e",
			Surface = "#16213e",
			AppbarBackground = "#0f0f1a",
			AppbarText = "#ffffff",
			DrawerBackground = "#16213e",
			DrawerText = "#ffffff",
			TextPrimary = "#e8e8e8",
			TextSecondary = "#b0b0b0",
			ActionDefault = "#9e9e9e",
			ActionDisabled = "#5a5a5a",
			Divider = "#2a2a4a",
			LinesDefault = "#2a2a4a",
			TableLines = "#2a2a4a",
			Error = "#f44336",
			Success = "#4caf50",
			Warning = "#ff9800",
			Info = "#2196f3"
		}
	};

	private async Task OpenSettings()
	{
		var options = new DialogOptions
		{
			CloseOnEscapeKey = true,
			MaxWidth = MaxWidth.Small,
			FullWidth = true
		};

		await DialogService.ShowAsync<SettingsDialog>("Settings", options);
	}

	private async Task OpenHistory()
	{
		var options = new DialogOptions
		{
			CloseOnEscapeKey = true,
			MaxWidth = MaxWidth.Large,
			FullWidth = true
		};

		await DialogService.ShowAsync<ActionHistoryDialog>("Action History", options);
	}
}
